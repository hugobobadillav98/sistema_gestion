{% extends 'base/base.html' %}

{% block title %}Pedidos{% endblock %}
{% block page_title %}Pedidos{% endblock %}
{% block mobile_title %}Pedidos{% endblock %}

{% block content %}
<div class="d-flex justify-content-between mb-3">
  <div>
    <p class="text-muted mb-0">Gestión de pedidos de clientes</p>
  </div>
</div>

<div class="card">
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th>Número</th>
            <th>Cliente</th>
            <th>Fecha</th>
            <th>Estado</th>
            <th class="text-end">Total</th>
            <th class="text-end">Acciones</th>
          </tr>
        </thead>
        <tbody>
          {% for order in orders %}
          <tr>
            <td>
              <a href="{% url 'orders:detail' order.pk %}" class="text-decoration-none">
                {{ order.order_number }}
              </a>
              {% if order.quote %}
              <br>
              <small class="text-muted">
                <i class="bi bi-file-earmark-text"></i> 
                Desde {{ order.quote.quote_number }}
              </small>
              {% endif %}
            </td>
            <td>{{ order.customer.name }}</td>
            <td>{{ order.order_date|date:"d/m/Y" }}</td>
            <td>
              <span class="badge
                {% if order.status == 'pending' %}bg-warning text-dark
                {% elif order.status == 'in_progress' %}bg-info
                {% elif order.status == 'completed' %}bg-success
                {% elif order.status == 'cancelled' %}bg-danger
                {% else %}bg-secondary{% endif %}">
                {{ order.get_status_display }}
              </span>
            </td>
            <td class="text-end">₲ {{ order.total|floatformat:0 }}</td>
            <td class="text-end">
              <a href="{% url 'orders:detail' order.pk %}" class="btn btn-sm btn-outline-primary">
                Ver
              </a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="6" class="text-center py-4 text-muted">
              <i class="bi bi-inbox fs-1 d-block mb-2"></i>
              No hay pedidos registrados aún.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
